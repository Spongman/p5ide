self.addEventListener("install",function(e){e.waitUntil(self.skipWaiting())}),self.addEventListener("activate",function(e){e.waitUntil(self.clients.claim())}),self.addEventListener("fetch",e=>{if(!e.clientId)return;let t=e.request.url,s=self.location.origin;t.startsWith(s)?e.respondWith(new Promise((s,n)=>{self.clients.get(e.clientId).then(e=>{let n=new MessageChannel;n.port1.onmessage=function(e){let t=e.data;if(t){if(t.status){let e=new Response;e.status=t.status,e.statusText=t.statusText||"error",s(e)}else if(t.type){let e=new Response(t);e.type=t.type,e.headers["Content-Type"]=t.type,e.headers["Cache-Control"]="no-store",s(e)}}else{let e=new Response;e.status=404,e.statusText="baloney!",s(e)}},e.postMessage(t,[n.port2])}).catch(n)})):console.log("REJECT: "+t)});